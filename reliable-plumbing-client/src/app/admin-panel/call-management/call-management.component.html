<loader *ngIf="loading"></loader>
<ng-container *ngIf="!loading">
  <div class="row filters">
    <div class="col-sm-6">
      <div class="row">
        <div class="col-sm-6">
          <p-multiSelect [options]="services" [(ngModel)]="selectedServices" [panelStyle]="{minWidth:'100%'}" (onPanelHide)="filter($event)">
            <ng-template let-service pTemplate="item">
              <span>{{service.value.name}}</span>
            </ng-template>
          </p-multiSelect>
        </div>

        <div class="col-sm-6">
          <p-calendar [(ngModel)]="rangeDates" [showIcon]="true" selectionMode="range" readonlyInput="true" (onClose)="filter($event)"></p-calendar>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="ui-inputgroup">
            <input type="text" class="customer-name" pInputText placeholder="Customer Name" [(ngModel)]="customerName" (keyup.enter)="filter()">
            <button pButton type="button" icon="fa fa-search" class="ui-button-secondary" (click)="filter()"></button>
          </div>
        </div>
      </div>
    </div>

    <div class="col-sm-6">

    </div>

  </div>

  <div class="row no-gutters">
    <div class="col-sm-6 status-tabs">
      <ngb-tabset>
        <ngb-tab *ngFor="let tab of statusTabs">
          <ng-template ngbTabTitle>
            <div class="status-tab-header" [pTooltip]="tab.text" tooltipPosition="bottom" showDelay="100" hideDelay="300">
              <i [ngClass]="tab.icon"></i>
              <span>{{tab.id == '0' ? 'All ' : ''}}({{mappedCalls[tab.id].callsCount}})</span>
            </div>
          </ng-template>
          <ng-template ngbTabContent>
            <p-scrollPanel [style]="{width: '100%', height: '100vh'}" styleClass="custom-left-scrollbar">
              <div class="timeline-content">
                <ul class="timeline">
                  <ng-container *ngFor="let groupDate of datesArrayBetweenFilterDates">
                    <li class="group-date">
                      <h3>{{groupDate | date}}</h3>
                    </li>
                    <li *ngIf="mappedCalls[tab.id][groupDate] == null || mappedCalls[tab.id][groupDate].length == 0">
                      <!-- <no-data [message]="'No Calls'"></no-data> -->
                      No Calls
                    </li>
                    <li *ngFor="let call of mappedCalls[tab.id][groupDate]" class="call" [class.selected]="call.id == selectedCall.id" (click)="selectedCall = call"
                      [attr.data-date]="call.time">
                      <h3>{{call.customerName}}</h3>
                    </li>
                  </ng-container>

                </ul>
              </div>
            </p-scrollPanel>
          </ng-template>
        </ngb-tab>
      </ngb-tabset>

    </div>
    <div class="col-sm-6">
      <ng-container>
        <p-scrollPanel [style]="{width: '100%', height: '100vh', marginTop: '35px'}" styleClass="custom-scrollbar">
          <div class="call-details" *ngIf="calls && calls.length > 0">
            <call-details [call]="selectedCall"></call-details>
          </div>
        </p-scrollPanel>
      </ng-container>
    </div>

  </div>
</ng-container>